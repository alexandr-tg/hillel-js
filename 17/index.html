<!DOCTYPE html>

<html lang="en">

<head>

    <meta charset="UTF-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Document</title>

    <style>

        .modal {

            width: 60vw;

            height: 300px;

            position: absolute;

            border: 1px solid #ccc;

            border-radius: 15px;

            box-shadow: 0px 0px 5px 3px #ccc;

            padding: 15px;

            left: calc(50vw - 30vw);

            top: calc(50vh - 150px);

        }

        .hide {
            display: none;
        }

    </style>

</head>

<body>





<div class="modal">

    <h1>SALE!!!!</h1>

    <h3>только до <span class="endSalesDay">15.04.2021</span>!!!!</h3>

    <br>

    <h3>Осталось времени</h3>

    <span class="left-time">00:00:00</span>

    <button class="sale-popup-bay">Купить</button>

    <button class="sale-popup-close">Закрыть</button>

</div>



<script>

    var salePopupBay = document.querySelector('.sale-popup-bay');
    var salePopupClose = document.querySelector('.sale-popup-close');
    var popupBlock = document.querySelector('.modal');
    var leftTime = document.querySelector('.left-time');
    setInterval(showLeftTime, 1000);


    salePopupBay.addEventListener('click', popupBay);
    salePopupClose.addEventListener('click', popupClose);



    function popupBay() {
        localStorage.setItem('Sale', true);
        localStorage.setItem('ShowSalePopup', JSON.stringify({isShow: false,time: 0}));
        hidePopup();
    }


    function popupClose() {
        localStorage.setItem('Sale', false);
        localStorage.setItem('ShowSalePopup', JSON.stringify({isShow: true, time: 10000}));
        hidePopup();
        var info = JSON.parse(localStorage.getItem('ShowSalePopup'));
        if(info.isShow) setInterval(showPopup, info.time);
    }


    function hidePopup(){
        popupBlock.classList.add('hide');
    }


    function showPopup(){
        popupBlock.classList.remove('hide');
    }


    function showLeftTime(){
        var endDate = new Date(2021, 3, 15).getTime();
        var left = endDate - new Date();
        var result = new Date(left);
        var text = `${result.getUTCDate()-1}:${result.getUTCHours()}:${result.getUTCMinutes()}:${result.getUTCSeconds()}`;
        leftTime.innerText = text;
    }

</script>

</body>

</html>